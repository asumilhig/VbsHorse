----------VbsHouse----------
版本		1.0
----------------------------
完成时间	12/28/2012
----------------------------
作者 		王紫川
----------------------------
学号 		092969
----------------------------

本文档主要用于介绍VbsHouse的功能、程序执行流程、程序结构以及作者的一些编写思路和心得体会。

============================

功能:

开机自启动，感染U盘，记录键盘录入并通过邮件发送。

本程序仅用于研究vbs脚本病毒的原理和基本实现，为了方便测试和保证测试的安全性，很多地方有意省略了大规模破坏性操作，而是对特定的文件夹进行破坏测试，也没有进行大量增殖和破坏注册表等恶意操作。

本程序支持64位系统。

============================

程序执行流程:

1.双击执行VbsHouse.vbs脚本文件,监测是否为64位系统，且默认WScript解释器为64位，如是，则强制以32位WScript解释器重新解释脚本
2.VbsHouse提升自身权限并拷贝dynwrap.dll到system32文件夹下，并制作自己的副本到特定文件夹中
3.修改注册表，使脚本程序开机自启动
4.VbsHouse感染特定文件夹中html, txt, log文件
5.VbsHouse主动监测U盘插入事件，并感染U盘
6.VbsHouse主动监测特定文件的键盘输入，并发送结果到指定邮箱

============================

程序结构:

============================

心得体会:

最开始看到期末项目要求的时候曾经冒出过很多想法，但是完全不知道如何去实现。无奈之下向已经毕业的一位学长要来了当时他写过的项目，他用C++写了一个木马程序，开机自启动，记录键盘，通过邮件发送，并能感染U盘。这个项目的思路给了我很多启发，然而当我真正运行的时候却发现了一些不尽如人意的地方，比如因为是用VS2008写就，如果目标机缺少VS2008运行时环境，就会报错等。而且网络安全问题提了这么多年，但凡用电脑的人就知道exe文件是不能随便打开的，这在社会工程学层面为这个木马的传播制造了障碍。

后来开始在网上搜寻资料，突然发现原来很多有名的木马和病毒都是通过脚本实现的，其中有很多又是通过VB Script写就的，被称为VBS病毒。VBS病毒用功能强大的脚本语言VB Script编写而成，在大多数Windows计算机上可以直接运行，该脚本语言功能非常强大，可以调用很多现成的Windows对象与组件，直接对文件系统、注册表进行控制。除此以外,VBS病毒还有很多优良的特性:

1.病毒以明文方式传播，获取后可以直接修改，增加病毒变异的可能
2.编写简单，一个对病毒一无所知的爱好者也可以在短时间内编写新种的病毒
3.欺骗性强，很多普通用户不知道以vbs为后缀的文件可能是破坏力很强的病毒

综合以上种种原因，我最终选择了学习并使用VB Script来实现之前学长用C++实现的功能。

在一番尝试之后，我总结了以下的经验教训，算是给未来的学习者一点前车之鉴。

1.如何使用VBS访问Win32 API
2.如何让程序强制以32位WScript解释器解释
3.如何让VBS程序在开机自启动